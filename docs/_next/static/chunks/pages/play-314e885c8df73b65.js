(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[141],{7454:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/play",function(){return s(8602)}])},8602:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return w}});var r=s(5893),n=s(2237),i=s(7294),o=s(4420),a=s.n(o),l=s(4480);let d=(0,l.cn)({key:"keyboardState",default:{}});function x(){let e=(0,l.Zl)(d);return(0,i.useEffect)(()=>{let t=t=>{e(e=>({...e,[t.code]:!0}))},s=t=>{e(e=>({...e,[t.code]:!1}))};return window.addEventListener("keydown",t),window.addEventListener("keyup",s),()=>{window.removeEventListener("keydown",t),window.removeEventListener("keyup",s)}},[]),null}let c=e=>{let[t]=a()("kodai_dodo.png"),[s]=a()("kodai_dodo_fated.png"),i=e.fated?s:t;return(0,r.jsxs)(n.ZA,{children:[(0,r.jsx)(n.Ee,{image:i,x:e.pos.x+e.disp_d.x-75,y:e.pos.y+e.disp_d.y-73,width:150,height:146}),(0,r.jsx)(n.Cd,{stroke:"red",strokeWidth:2,x:e.pos.x,y:e.pos.y,radius:50})]})},p={TIGER:"animal_fukuroookami_tasmanian_tiger.png",VELOCI:"Velociraptor.png",MICRO:"kodai_microraptor.png"},h=()=>[{pos:{x:700,y:540},charactor:"TIGER"},{pos:{x:-100,y:520},charactor:"VELOCI"},{pos:{x:700,y:300},charactor:"MICRO"}][Math.floor(3*Math.random())],u=(e,t)=>{let s=e;return"TIGER"==e.charactor?s.pos.x+=-300*t:"VELOCI"==e.charactor?s.pos.x+=300*t:"MICRO"==e.charactor&&(s.pos.x+=-400*t),s},y=e=>{let[t]=a()(p[e.charactor]),s="VELOCI"==e.charactor?-1:1;return(0,r.jsxs)(n.ZA,{children:[(0,r.jsx)(n.Ee,{image:t,x:e.pos.x-84*s,y:e.pos.y-69,width:168,height:138,scaleX:s}),(0,r.jsx)(n.Cd,{stroke:"blue",strokeWidth:2,x:e.pos.x,y:e.pos.y,radius:50})]})},m=e=>(0,r.jsxs)(n.ZA,{children:[(0,r.jsx)(n.UL,{fill:"gray",width:200,height:100,...e,x:e.x-100,y:e.y-50,onClick:e.callback}),(0,r.jsx)(n.xv,{text:"RETRY",...e})]}),f=e=>{let{t,player:s,enemies:i,gameOver:o,handleRetry:a}=e;return(0,r.jsxs)(n.mh,{children:[(0,r.jsx)(n.UL,{fill:"red",x:100,y:100,width:300,height:200}),(0,r.jsx)(n.UL,{fill:"red",x:400,y:350,width:50,height:50}),(0,r.jsx)(n.UL,{fill:"blue",x:50,y:350,width:50,height:50}),(0,r.jsx)(n.Cd,{fill:"blue",x:20,y:100,radius:50,opacity:.5}),(0,r.jsx)(n.Pj,{fill:"green",x:250,y:300,radiusX:100,radiusY:180}),(0,r.jsx)(n.x1,{points:[400,50,300,150,150,170,300,50],stroke:"purple",strokeWidth:15}),i.map(e=>(0,r.jsx)(y,{...e})),(0,r.jsx)(c,{...s}),(0,r.jsx)(n.xv,{x:10,y:10,text:String(Math.floor(t))}),o&&(0,r.jsx)(m,{x:300,y:300,callback:a})]})},j=e=>{let{handleClick:t,handleRetry:s,width:i,height:o,game:a}=e;return(0,r.jsxs)(n.Hf,{width:i,height:o,className:"flex justify-center",onKeyPress:e=>console.log(e),onClick:()=>t(),children:[(0,r.jsx)(n.mh,{children:(0,r.jsx)(n.UL,{stroke:"black",strokeWidth:4,x:2,y:2,width:i-4,height:o-4})}),(0,r.jsx)(f,{...a,handleRetry:s})]})},g=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{},t=(0,i.useRef)(0),s=(0,i.useCallback)(()=>{t.current=requestAnimationFrame(s),e()},[e]);(0,i.useEffect)(()=>(t.current=requestAnimationFrame(s),()=>cancelAnimationFrame(t.current)),[s])};function w(){(0,i.useRef)();let[e,t]=(0,i.useState)({t:0,spawner:{prevT:0},player:{t:0,pos:{x:275,y:623},disp_d:{x:0,y:0},v:{x:0,y:0},jumping:!0,fated:!1},enemies:[],gameOver:!1}),s=(0,l.sJ)(d);g(()=>{let r=1/60,n=e.player,i=e.t+r,a=e.spawner,l=n;l.t+=r,l.fated||(l.jumping?(l.pos.y=n.pos.y+n.v.y*r,l.pos.y+100<623?l.v.y+=1500*r:(l.jumping=!1,l.pos.y=523,l.v.y=0),l.disp_d={x:0,y:0}):l.disp_d={x:0,y:-10*Math.abs(Math.sin(10*l.t))});let d=e.enemies.map(e=>u(e,r)).filter(e=>e.pos.x>=-200&&e.pos.x<=800);e.t>a.prevT+2&&(d.push(h()),a.prevT+=2);let x=e.enemies.some(e=>Math.pow(e.pos.x-n.pos.x,2)+Math.pow(e.pos.y-n.pos.y,2)<1e4);x&&(l.fated=!0),t({t:i,spawner:a,player:l,enemies:d,gameOver:e.gameOver||x}),"Space"in s&&s.Space&&o()});let n=()=>{console.log("jump"),e.player.jumping||(e.player.jumping=!0,e.player.v.y=-1e3,t(e))},o=()=>{n()},a=()=>{console.log("handle retry")};return(0,r.jsxs)("main",{className:"flex min-h-screen flex-col items-center justify-between p-4",children:[(0,r.jsx)("div",{className:"z-10 w-full max-w-5xl items-center justify-between font-mono text-sm lg:flex",children:(0,r.jsx)(j,{handleClick:()=>o(),handleRetry:a,width:600,height:600,game:e})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{children:"Pressed keys:"}),(0,r.jsx)("ul",{children:Object.keys(s).map(e=>(0,r.jsxs)("li",{children:[e,": ",s[e].toString()]},e))})]}),(0,r.jsx)(x,{})]})}}},function(e){e.O(0,[289,774,888,179],function(){return e(e.s=7454)}),_N_E=e.O()}]);